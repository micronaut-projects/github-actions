name: Pre-build steps for graalvm workflow
description: Runs pre-build steps for graalvm workflow
inputs:
  graalvm:
    description: 'GraalVM version'
    required: true
  java:
    description: 'Java version'
    required: true
runs:
  using: "composite"
  steps:
    # https://github.com/actions/virtual-environments/issues/709
    - name: "Free disk space"
      shell: bash
      run: |
        sudo rm -rf "/usr/local/share/boost"
        sudo rm -rf "$AGENT_TOOLSDIRECTORY"
        sudo apt-get clean
        df -h

    - name: "Checkout repository"
      uses: actions/checkout@v3
      with:
        fetch-depth: 0

    - name: "Setup GraalVM CE"
      uses: graalvm/setup-graalvm@v1
      with:
        version: ${{ inputs.graalvm }}
        java-version: ${{ inputs.java }}
        components: 'native-image'

    - name: "Setup Gradle"
      uses: gradle/gradle-build-action@v2

    - name: "Optional setup step"
      shell: bash
      run: |
        [ -f ./setup.sh ] && ./setup.sh || [ ! -f ./setup.sh ]
